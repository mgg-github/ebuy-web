define("home/widget/head_setUserInfo",function(require,exports,module){var i=require("load_async"),e=require("conf"),t=function(i){$.each(["$con","$btnp","$btnn"],function(e,t){i[t]instanceof $||(i[t]=0===e?$(i[t]):$(i[t],i.$ctn))}),this.opts={},$.extend(this,new _.Events),$.extend(this.opts,{},i),this._pageSize=i.pageSize||i.$ctn.width(),this._slideSize=i.slideSize||i.$con.width(),this._windowSize=i.windowSize||i.$ctn.width(),this._pageNow=0,this._pos=0,this._toPos=0,this._pageCnt=this._slideSize/this._pageSize,this._pagePerWindow=this._windowSize/this._pageSize};t.prototype=$.extend({},_.Events.prototype),t.prototype.init=function(){this.opts.infinite&&(this._fakeDom=this.opts.$con.children().clone(),this.opts.$con.append(this._fakeDom).css("width",2*this._slideSize+"px")),this._bind()},t.prototype._bind=function(){var i,e=this;i=function(i){return function(){e.opts.$con.is(":animated")||i()}},this.opts.$btnp.bind("click",i(function(){e._prev()})),this.opts.$btnn.bind("click",i(function(){e._next()}))},t.prototype._switchTo=function(i){var e=this;this.opts.$con.stop().animate({left:-i*this._pageSize+"px"},this.opts.speed,function(){e._pos=-i*e._pageSize})},t.prototype._next=function(){var i=this._pageNow+1;if(this.opts.infinite)i>2*this._pageCnt-this._pagePerWindow-.01&&(i-=this._pageCnt,this.opts.$con.css("left",this._pos+this._slideSize)),this._pageNow=i;else{if(i>this._pageCnt-.01)return;this._pageNow=Math.round(i%this._pageCnt)}this._switchTo(this._pageNow)},t.prototype._prev=function(){if(!this.opts.$con.is(":animated")){var i=this._pageNow-1;if(this.opts.infinite)i<-.01&&(i=this._pageCnt+i,this.opts.$con.css("left",this._pos-this._slideSize)),this._pageNow=i;else{if(i<-.01)return;this._pageNow=Math.round((this._pageCnt+i)%this._pageCnt)}this._switchTo(this._pageNow)}};var s=function(i){var e={};this.opts=$.extend({},e,i)};s.prototype.init=function(){var t=this;i({url:e.INTERFACE.USER_NAME,timeout:1e3,params:{pin:this.pin,uuid:this.uuid},scriptCharset:"gb2312",jsonpCallback:"jsonpCallbackHelloService"}).then(function(i){i&&(t._setUsername(i),t._sso(i),t._setPop())})},s.prototype._setUsername=function(i){if(i.nick){var e=this.opts.$userName;if(e.html('<div class="dt cw-icon">        <i class="icon-plus-nickname"></i>        <i class="ci-right"><s>◇</s></i>        <a class="nickname" target="_blank" href="//home.taotao.com/">'+i.nick+'</a>        <i class="iconfont">&#xe605;</i>      </div>      <div class="dd dorpdown-layer"></div>'),e.addClass("dorpdown").dropdown({enterDelay:100,trigger:!0,current:"hover",onchange:function(){createCookie("userInfo2016","1",1e4,"/"),$(".u-place-tip").hide()}}),!readCookie("userInfo2016")){var t=$('<div class="u-place-tip">          <i class="iconfont u-place-tip-ico">&#xe604;</i>          我的福利特权都在这里了哟～          <i class="iconfont u-place-tip-close J_utipclose">&#xe600;</i>        </div>').css("left",e.offset().left);_.eventCenter.on("home:resize",function(){t.css("left",e.offset().left)}),$(document.body).append(t),t.delegate(".J_utipclose","click",function(i){createCookie("userInfo2016","1",10,"/"),t.hide()})}}else this.opts.$userName.html(i.info)},s.prototype._sso=function(i){i.sso&&$.each(i.sso,function(i,e){$.getJSON(e)})},s.prototype._setPop=function(){var s,n,o,a,p=this;s={zymyf:{url:"//vip.taotao.com/help.html#mypri-01",name:"自营运费补贴",isLong:!0},shfw:{url:"//vip.taotao.com/help.html#mypri-02",name:"售后服务"},pjjl:{url:"//vip.taotao.com/help.html#mypri-03",name:"评价奖励"},zjfw:{url:"//vip.taotao.com/help.html#mypri-06",name:"装机服务"},hytj:{url:"//vip.taotao.com/help.html#mypri-04",name:"会员特价"},srlb:{url:"//vip.taotao.com/help.html#mypri-05",name:"生日礼包"},zxlb:{url:"//vip.taotao.com/help.html#mypri-07",name:"专享礼包"},gbzx:{url:"//vip.taotao.com/help.html#mypri-08",name:"贵宾专线"},yfq:{url:"//vip.taotao.com/help.html#mypri-09",name:"运费券"}},n={1:[["zymyf","shfw","pjjl","zjfw"],["hytj","srlb","zxlb","gbzx","yfq"]],2:[["zymyf","shfw","pjjl","hytj","zjfw"],["srlb","zxlb","gbzx","yfq"]],3:[["zymyf","shfw","pjjl","hytj","srlb","zjfw"],["zxlb","gbzx","yfq"]],4:[["zymyf","shfw","pjjl","hytj","srlb","zxlb","zjfw"],["gbzx","yfq"]],5:[["zymyf","shfw","pjjl","hytj","srlb","zxlb","zjfw","gbzx","yfq"]]},o=function(i){var e=n[i]||n[5],t=e[0],o=e[1]||[],a=[];return $.each(t,function(i,e){var t=s[e];a.push('<div class="badge-panel'+(t.isLong?" badge-panel_long":"")+'"><a href="'+t.url+'" target="_blank"><i class="icobadage icobadage_'+e+'"></i><p class="u-name">'+t.name+"</p></a></div>")}),$.each(o,function(i,e){var t=s[e];a.push('<div class="badge-panel u-dis"><a href="'+t.url+'" target="_blank"><i class="icobadage icobadage_'+e+'"></i><p class="u-name">'+t.name+"</p></a></div>")}),a.join("")},i({url:e.INTERFACE.LOGIN_SERVICE,timeout:1e3,jsonpCallback:"jsonpCallbackIsLogin"}).then(function(i){pageConfig.loginDefer.resolve(i)},function(){pageConfig.loginDefer.resolve()}),pageConfig.loginDefer.then(function(t){t&&t.Identity&&t.Identity.IsAuthenticated?i({url:e.INTERFACE.USER_INFO,timeout:1e3,jsonpCallback:"jsonpCallbackRequestUserInfo"}).then(function(i){pageConfig.userInfoDefer.resolve(i)},function(){pageConfig.userInfoDefer.reject()}):pageConfig.userInfoDefer.reject()}),a=function(i){var e,s,n,a,c,i=i||{},l=i.imgUrl||"//taotao.com/mtd/pc/common/img/no_login.jpg",r=i.userLevel||1,h=Number(i.plusStatus)||"5";switch(h){case 1:n=!0,a="开通正式版";break;case 2:n=!1,a="开通正式版";break;case 3:n=!0,a="PLUS专享";break;case 4:n=!1,a="PLUS续费";break;default:n=!1,a="免费试用",h=0}var d;d=pageConfig.plusMap[r-1]||plus.plusMap[0],d=d[h]||d[4],s=['<a href="'+d[0]+'" target="_blank">',d[1],"</a>"].join(""),e='<div class="dd-spacer"></div>        <div class="userinfo">          <div class="u-pic">            <a target="_blank" href="//home.taotao.com/">              <img class="J_upic_img" src="//taotao.com/mtd/pc/common/img/no_login.jpg" width="60" height="60" />            </a>          </div>          <div class="u-plus">            <a href="https://passport.taotao.com/uc/login?ltype=logout" class="link-logout">退出</a>            <a href="https://plus.taotao.com/index" target="_blank" class="icon-plus-dropdown"></a>          </div>          <div class="u-msg">'+s+"</div>        </div>",c='<div class="badge-list J_sliderwrap">        <a href="javascript:void(0);" class="badge-list-prev J_slider_btnp"><i class="iconfont">&#xe602;</i></a>        <div class="u-badges J_slider_ctn">          <div class="badge-panel-main J_slider_con">            <div class="badge-panel fore1'+(n?"":" u-dis ")+'">              <a href="https://plus.taotao.com/index" target="_blank">                <i class="icobadage icobadage_plus"></i>                <p class="u-name">'+a+"</p>              </a>            </div>"+o(r)+'</div>        </div>        <a href="javascript:void(0);" class="badge-list-next J_slider_btnn"><i class="iconfont">&#xe601;</i></a>      </div>',$(".dd",p.opts.$userName).html(e+c);var f=$(".J_sliderwrap",p.opts.$userName);$(function(){$(".J_upic_img").attr("src",l)}),new t({$ctn:$(".J_slider_ctn",f),$con:$(".J_slider_con",f),$btnp:$(".J_slider_btnp",f),$btnn:$(".J_slider_btnn",f),pageSize:140,windowSize:210,infinite:!1,speed:200}).init(),p.opts.$userName.addClass("icon-plus-state"+h)},pageConfig.userInfoDefer.then(function(i){a(i)},function(){a()})},module.exports=s});