define("home/widget/head_shoppingcart",["//taotao.com/jdf/1.0.0/ui/dropdown/1.0.0/dropdown.js","load_async","o2tpl"],function(require,exports,module){function t(){s.init()}var i=(require("//taotao.com/jdf/1.0.0/ui/dropdown/1.0.0/dropdown.js"),require("o2tpl")),a=require("load_async");window.pageConfig=window.pageConfig||{},pageConfig.shoppingcartUrl="//cart.taotao.com/";var s={el:null,init:function(){var t=this;t.el=$("#settleup"),t.el.find(".ci-right").html("&gt;"),t.el.find(".dorpdown-layer").html('<div id="J_cart_pop"><span class="loading"></span></div>'),t.el.find(".cw-icon .ci-right").after('<i class="ci-count" id="shopping-amount"></i>'),null!=t.DATA_Amount&&$("#shopping-amount").html(t.DATA_Amount),null!=this.el&&this.el.dropdown({enterDelay:500,trigger:!0,current:"hover",onchange:function(){t.FN_Refresh()}})},DATA_Cookie:"cn",DATA_Amount:readCookie("cn")||"0",URL_Serv:"//cart.taotao.com/cart/miniCartServiceNew.action",TPL_NoGoods:'      <div class="cart_pop">        <div class="cart_empty">          <i class="cart_empty_img"></i>          购物车中还没有商品，赶紧选购吧！        </div>      </div>',TPL_List:{wrap:'        <div id="J_cart_pop" class="cart_pop">          <div class="cart_hd">            <h4 class="cart_hd_title">最新加入的商品</h4>          </div>          <div class="cart_bd J_cart_bd"></div>          <div class="cart_ft">            <div class="cart_ft_info">              共<span class="cart_num">{%= o.Num %}</span>件商品　共计<span class="cart_num">&yen; {%= o.TotalPromotionPrice.toFixed(2) %}</span>            </div>            <a class="cart_ft_lk" href="{%= pageConfig.shoppingcartUrl %}" title="去购物车">去购物车</a>          </div>        </div>',single:'        <ul class="cart_singlelist">          {% $.each(o.TheSkus, function (k, list) { %}            <li class="cart_item">              <div class="cart_item_inner">                <div class="cart_img">                  <a class="cart_img_lk" href="//item.taotao.com/{%= list.Id %}.html" target="_blank">                    <img src="{%= pageConfig.FN_GetImageDomain(list.Id) %}n5/{%= list.ImgUrl %}" width="50" height="50" alt="">                  </a>                </div>                <div class="cart_name">                  <a class="cart_name_lk" href="//item.taotao.com/{%= list.Id %}.html" title="{%= list.Name %}" target="_blank">{%= list.Name %}</a>                </div>                <div class="cart_info">                  <div class="cart_price">&yen;{%= list.PromotionPrice.toFixed(2) %}×{%= list.Num %}</div>                  {% if (parseInt(list.FanPrice) > 0) { %}                    <div class="cart_tag cart_tag_green">返现：&yen;{%= list.FanPrice %}</div>                  {% } %}                  {% if (parseInt(list.Score) > 0) { %}                    <div class="cart_tag cart_tag_orange">送京豆：{%= list.Score %}</div>                  {% } %}                  <a class="cart_delete J_delete" data-id="{%= list.Id %}" data-method="RemoveProduct" data-type="{%= list.ItemType %}" href="javascript:;">删除</a>                </div>                {% $.each(list.CouponAD, function (k, jq) { %}                  <div class="cart_gift cart_gift_jq">[赠券] 赠送{%= jq.Jing %}京券 {%= jq.LimitAd %}                </div>                {% }); %}              </div>            </li>          {% }); %}\t\t\t\t</ul>',gift:'        <ul class="cart_giftlist">          {% $.each(o.TheGifts, function (k, list) { %}            <li class="cart_item">              <div class="cart_item_inner">                <div class="cart_img">                  <a class="cart_img_lk" href="//item.taotao.com/{%= list.MainSKU.Id %}.html" target="_blank">                    <img src="{%= pageConfig.FN_GetImageDomain(list.MainSKU.Id) %}n5/{%= list.MainSKU.ImgUrl %}" width="50" height="50" alt="">                  </a>                </div>                <div class="cart_name">                  <a class="cart_name_lk" href="//item.taotao.com/{%= list.MainSKU.Id %}.html" title="{%= list.MainSKU.Name %}" target="_blank">{%= list.MainSKU.Name %}</a>                </div>                <div class="cart_info">                  <div class="cart_price">&yen;{%= list.PromotionPrice.toFixed(2) %}×{%= list.Num %}</div>                  {% if (parseInt(list.FanPrice) > 0) { %}                    <div class="cart_tag cart_tag_green">返现：&yen;{%= list.FanPrice %}</div>                  {% } %}                  {% if (parseInt(list.Score) > 0) { %}                    <div class="cart_tag cart_tag_orange">送京豆：{%= list.Score %}</div>                  {% } %}                  <a class="cart_delete J_delete" data-id="{%= list.MainSKU.Id %}" data-method="RemoveProduct" data-type="{%= list.MainSKU.ItemType %}" href="javascript:;">删除</a>                </div>                {% $.each(list.Skus, function (k, gift) { %}                  <div class="cart_gift">                    <a class="cart_gift_lk" href="//item.taotao.com/{%= gift.Id %}.html" target="_blank">[{% if(gift.Type==2) { %}赠品{% } %}{% if(gift.Type==1) { %}附件{% } %}] {%= gift.Name %}</a>                  </div>                {% }); %}                {% $.each(list.CouponAD, function (k, jq) { %}                  <div class="cart_gift cart_gift_jq">[赠券] 赠送{%= jq.Jing %}元京券 {%= jq.LimitAd %}                </div>                {% }); %}              </div>            </li>\t\t\t\t  {% }); %}\t\t\t\t</ul>',suit:'        <ul class="cart_suitlist">          {% $.each(o.TheSuit, function (k, suit) { %}            {% var isVirtual = !!suit.VskuId; %}            <li class="cart_item cart_suit{%= isVirtual ? " cart_suit_virtual" : "" %}">              <div class="cart_item_hd">                <div class="cart_item_hd_info">                  {% if (isVirtual) { %}                    <a href="//item.taotao.com/{%= suit.VskuId %}.html" target="_blank">                      <span class="cart_suit_tag">[套装]</span> {%= suit.Name %}                    </a>                  {% } else { %}                    <span class="cart_suit_tag">[套装]</span> {%= suit.Name %}                  {% } %}                </div>                {% if (isVirtual) { %}                  <a class="cart_delete J_delete" data-id="{%= suit.VskuId %}" data-method="RemoveSuit" data-type="{%= suit.SuitType %}" href="javascript:;">删除</a>                {% } %}                <div class="cart_item_hd_price">小计：<span class="cart_num">&yen;{%= (suit.PromotionPrice*suit.Num).toFixed(2) %}</span></div>              </div>              <ul class="cart_item_bd">                {% $.each(suit.Skus, function (k, list) { %}                  <li class="cart_item">                    <div class="cart_item_inner">                      <div class="cart_img">                        <a class="cart_img_lk" href="//item.taotao.com/{%= list.Id %}.html" target="_blank">                          <img src="{%= pageConfig.FN_GetImageDomain(list.Id) %}n5/{%= list.ImgUrl %}" width="50" height="50" alt="">                        </a>                      </div>                      <div class="cart_name">                        <a class="cart_name_lk" href="//item.taotao.com/{%= list.Id %}.html" title="{%= list.Name %}" target="_blank">{%= list.Name %}</a>                      </div>                      <div class="cart_info">                        <div class="cart_price">&yen;{%= list.PromotionPrice.toFixed(2) %}×{%= list.Num %}</div>                        {% if (parseInt(list.FanPrice) > 0) { %}                          <div class="cart_tag cart_tag_green">返现：&yen;{%= list.FanPrice %}</div>                        {% } %}                        {% if (parseInt(list.Score) > 0) { %}                          <div class="cart_tag cart_tag_orange">送京豆：{%= list.Score %}</div>                        {% } %}                        {% if (!isVirtual) { %}                          <a class="cart_delete J_delete" data-id="{%= list.Id %}|{%= suit.Id %}" data-method="RemoveSuit" data-type="{%= list.ItemType %}" href="javascript:;">删除</a>                        {% } %}                      </div>                      {% $.each(list.Gifts, function (k, gift) { %}                        <div class="cart_gift">                          <a class="cart_gift_lk" href="//item.taotao.com/{%= gift.Id %}.html" target="_blank">[{% if(gift.Type==2) { %}赠品{% } %}{% if(gift.Type==1) { %}附件{% } %}] {%= gift.Name %}</a>                        </div>                      {% }); %}                      {% $.each(list.CouponAD, function (k, jq) { %}                        <div class="cart_gift cart_gift_jq">[赠券] 赠送{%= jq.Jing %}元京券 {%= jq.LimitAd %}                      </div>                      {% }); %}                    </div>                  </li>                {% }); %}              </ul>            </li>\t\t\t\t  {% }); %}        </ul>',mj:'        <ul class="cart_manjianlist">          {% $.each(o.ManJian, function (k, mj) { %}            <li class="cart_item">              <div class="cart_item_hd">                <div class="cart_item_hd_info">                  <span class="cart_tag cart_tag_green">满减</span>                  {% if (mj.ManFlag) { %}已购满{% if (mj.ManNum > 0) { %}{%= mj.ManNum %}件{% } else { %}{%= mj.ManPrice %}元{% } %}，已减{%= mj.JianPrice %}元                  {% } else { %}购满{% if (mj.ManNum > 0) { %}{%= mj.ManNum %}件{% } else { %}{%= mj.ManPrice %}元{% } %}，即可享受满减优惠{% } %}                  </div>                <div class="cart_item_hd_price">小计：&yen;{%= (mj.PromotionPrice*mj.Num).toFixed(2) %}</div>              </div>              {% if ($.isArray(mj.Skus) && mj.Skus.length) { %}                <ul class="cart_item_bd">                  {% $.each(mj.Skus, function (k, list) { %}                    <li class="cart_item">                      <div class="cart_item_inner">                        <div class="cart_img">                          <a class="cart_img_lk" href="//item.taotao.com/{%= list.Id %}.html" target="_blank">                            <img src="{%= pageConfig.FN_GetImageDomain(list.Id) %}n5/{%= list.ImgUrl %}" width="50" height="50" alt="">                          </a>                        </div>                        <div class="cart_name">                          <a class="cart_name_lk" href="//item.taotao.com/{%= list.Id %}.html" title="{%= list.Name %}" target="_blank">{%= list.Name %}</a>                        </div>                        <div class="cart_info">                          <div class="cart_price">&yen;{%= list.PromotionPrice.toFixed(2) %}×{%= list.Num %}</div>                          {% if (parseInt(list.FanPrice) > 0) { %}                            <div class="cart_tag cart_tag_green">返现：&yen;{%= list.FanPrice %}</div>                          {% } %}                          {% if (parseInt(list.Score) > 0) { %}                            <div class="cart_tag cart_tag_orange">送京豆：{%= list.Score %}</div>                          {% } %}                          <a class="cart_delete J_delete" data-id="{%= list.Id %}|{%= mj.Id %}" data-method="RemoveSuit" data-type="{%= list.ItemType %}" href="javascript:;">删除</a>                        </div>                        {% $.each(list.Gifts, function (k, gift) { %}                          <div class="cart_gift">                            <a class="cart_gift_lk" href="//item.taotao.com/{%= gift.Id %}.html" target="_blank">[{% if(gift.Type==2) { %}赠品{% } %}{% if(gift.Type==1) { %}附件{% } %}] {%= gift.Name %}</a>                          </div>                        {% }); %}                        {% $.each(list.CouponAD, function (k, jq) { %}                          <div class="cart_gift cart_gift_jq">[赠券] 赠送{%= jq.Jing %}元京券 {%= jq.LimitAd %}                        </div>                        {% }); %}                      </div>                    </li>                  {% }); %}                </ul>              {% } %}              {% if ($.isArray(mj.Suits) && mj.Suits.length) { %}                <ul class="cart_item_bd">                  {% $.each(mj.Suits, function (k, suit) { %}                    {% var isVirtual = !!suit.VskuId; %}                    <li class="cart_item cart_suit{%= isVirtual ? " cart_suit_virtual" : "" %}">                      <div class="cart_item_hd">                        <div class="cart_item_hd_info">                          {% if (isVirtual) { %}                            <a href="//item.taotao.com/{%= suit.VskuId %}.html" target="_blank">                              <span class="cart_suit_tag">[套装]</span> {%= suit.Name %}                            </a>                          {% } else { %}                            <span class="cart_suit_tag">[套装]</span> {%= suit.Name %}                          {% } %}                        </div>                        {% if (isVirtual) { %}                          <a class="cart_delete J_delete" data-id="{%= suit.VskuId %}|{%= mj.Id %}" data-method="RemoveSuit" data-type="{%= suit.SuitType %}" href="javascript:;">删除</a>                        {% } %}                        <div class="cart_item_hd_price">小计：<span class="cart_num">&yen;{%= (suit.PromotionPrice*suit.Num).toFixed(2) %}</span></div>                      </div>                      <ul class="cart_item_bd">                        {% $.each(suit.Skus, function (k, list) { %}                          <li class="cart_item">                            <div class="cart_item_inner">                              <div class="cart_img">                                <a class="cart_img_lk" href="//item.taotao.com/{%= list.Id %}.html" target="_blank">                                  <img src="{%= pageConfig.FN_GetImageDomain(list.Id) %}n5/{%= list.ImgUrl %}" width="50" height="50" alt="">                                </a>                              </div>                              <div class="cart_name">                                <a class="cart_name_lk" href="//item.taotao.com/{%= list.Id %}.html" title="{%= list.Name %}" target="_blank">{%= list.Name %}</a>                              </div>                              <div class="cart_info">                                <div class="cart_price">&yen;{%= list.PromotionPrice.toFixed(2) %}×{%= list.Num %}</div>                                {% if (parseInt(list.FanPrice) > 0) { %}                                  <div class="cart_tag cart_tag_green">返现：&yen;{%= list.FanPrice %}</div>                                {% } %}                                {% if (parseInt(list.Score) > 0) { %}                                  <div class="cart_tag cart_tag_orange">送京豆：{%= list.Score %}</div>                                {% } %}                                {% if (!isVirtual) { %}                                  <a class="cart_delete J_delete" data-id="{%= list.Id %}|{%= suit.Id %}" data-method="RemoveSuit" data-type="{%= list.ItemType %}" href="javascript:;">删除</a>                                {% } %}                              </div>                              {% $.each(list.Gifts, function (k, gift) { %}                                <div class="cart_gift">                                  <a class="cart_gift_lk" href="//item.taotao.com/{%= gift.Id %}.html" target="_blank">[{% if(gift.Type==2) { %}赠品{% } %}{% if(gift.Type==1) { %}附件{% } %}] {%= gift.Name %}</a>                                </div>                              {% }); %}                              {% $.each(list.CouponAD, function (k, jq) { %}                                <div class="cart_gift cart_gift_jq">[赠券] 赠送{%= jq.Jing %}元京券 {%= jq.LimitAd %}                              </div>                              {% }); %}                            </div>                          </li>                        {% }); %}                      </ul>                    </li>                  {% }); %}                </ul>              {% } %}            </li>\t\t\t\t  {% }); %}        </ul>',mz:'        <ul class="cart_manzenglist">          {% $.each(o.ManZeng, function (k, mz) { %}            <li class="cart_item">              <div class="cart_item_hd">                <div class="cart_item_hd_info">                  <span class="cart_tag cart_tag_orange">{% if(mz.FullRefundType == 24) { %}换购{% } else if (mz.AddMoney > 0) { %}加价购{% } else { %}满赠{% } %}</span>                  {% if(mz.AddMoney > 0 || mz.FullRefundType == 24) { %}                    {% if(mz.ManFlag) { %}                      已购满{% if (mz.FullRefundType == 24) { %}{%= mz.ManNum %}件{% } else { %}{%= mz.ManPrice %}元{% } %}，您{% if(mz.ManGifts.length > 0) { %}已{% } else { %}可{% } %}加价换购商品                    {% } else { %}                      购满{% if (mz.FullRefundType == 24) { %}{%= mz.ManNum %}件{% } else { %}{%= mz.ManPrice %}元{% } %}，即可加价换购商品                    {% } %}                  {% } else { %}                    {% if(mz.ManFlag) { %}                      已购满{%= mz.ManPrice %}元，您{% if(mz.ManGifts.length > 0) { %}已{% } else { %}可{% } %}领赠品                    {% } else { %}                      购满{%= mz.ManPrice %}元，即可领取赠品                    {% } %}                  {% } %}                </div>                <div class="cart_item_hd_price">小计：&yen;{%= (mz.PromotionPrice*mz.Num).toFixed(2) %}</div>              </div>              {% if ($.isArray(mz.ManGifts) && mz.ManGifts.length) { %}                <ul class="cart_item_bd">                  {% $.each(mz.ManGifts, function (k, gift) { %}                    <li class="cart_item cart_item_mz">                      <div class="cart_item_inner">                        <div class="cart_gift">                          <a class="cart_gift_lk" href="{%= gift.Id %}" target="_blank">[{% if(mz.AddMoney > 0 || mz.FullRefundType == 24) { %}换购品{% } else { %}赠品{% } %}]{%= gift.Name %}</a>×{%= gift.Num %}                        </div>                      </div>                    </li>                  {% }); %}                </ul>              {% } %}              {% if ($.isArray(mz.Skus) && mz.Skus.length) { %}                <ul class="cart_item_bd">                  {% $.each(mz.Skus, function (k, list) { %}                    <li class="cart_item">                      <div class="cart_item_inner">                        <div class="cart_img">                          <a class="cart_img_lk" href="//item.taotao.com/{%= list.Id %}.html" target="_blank">                            <img src="{%= pageConfig.FN_GetImageDomain(list.Id) %}n5/{%= list.ImgUrl %}" width="50" height="50" alt="">                          </a>                        </div>                        <div class="cart_name">                          <a class="cart_name_lk" href="//item.taotao.com/{%= list.Id %}.html" title="{%= list.Name %}" target="_blank">{%= list.Name %}</a>                        </div>                        <div class="cart_info">                          <div class="cart_price">&yen;{%= list.PromotionPrice.toFixed(2) %}×{%= list.Num %}</div>                          {% if (parseInt(list.FanPrice) > 0) { %}                            <div class="cart_tag cart_tag_green">返现：&yen;{%= list.FanPrice %}</div>                          {% } %}                          {% if (parseInt(list.Score) > 0) { %}                            <div class="cart_tag cart_tag_orange">送京豆：{%= list.Score %}</div>                          {% } %}                          <a class="cart_delete J_delete" data-id="{%= list.Id %}|{%= mz.Id %}" data-method="RemoveSuit" data-type="{%= list.ItemType %}" href="javascript:;">删除</a>                        </div>                        {% $.each(list.Gifts, function (k, gift) { %}                          <div class="cart_gift">                            <a class="cart_gift_lk" href="//item.taotao.com/{%= gift.Id %}.html" target="_blank">[{% if(gift.Type==2) { %}赠品{% } %}{% if(gift.Type==1) { %}附件{% } %}] {%= gift.Name %}</a>                          </div>                        {% }); %}                        {% $.each(list.CouponAD, function (k, jq) { %}                          <div class="cart_gift cart_gift_jq">[赠券] 赠送{%= jq.Jing %}元京券 {%= jq.LimitAd %}                        </div>                        {% }); %}                      </div>                    </li>                  {% }); %}                </ul>              {% } %}              {% if ($.isArray(mz.Suits) && mz.Suits.length) { %}                <ul class="cart_item_bd">                  {% $.each(mz.Suits, function (k, suit) { %}                    {% var isVirtual = !!suit.VskuId; %}                    <li class="cart_item cart_suit{%= isVirtual ? " cart_suit_virtual" : "" %}">                      <div class="cart_item_hd">                        <div class="cart_item_hd_info">                          {% if (isVirtual) { %}                            <a href="//item.taotao.com/{%= suit.VskuId %}.html" target="_blank">                              <span class="cart_suit_tag">[套装]</span> {%= suit.Name %}                            </a>                          {% } else { %}                            <span class="cart_suit_tag">[套装]</span> {%= suit.Name %}                          {% } %}                        </div>                        {% if (isVirtual) { %}                          <a class="cart_delete J_delete" data-id="{%= suit.VskuId %}|{%= mz.Id %}" data-method="RemoveSuit" data-type="{%= suit.SuitType %}" href="javascript:;">删除</a>                        {% } %}                        <div class="cart_item_hd_price">小计：<span class="cart_num">&yen;{%= (suit.PromotionPrice*suit.Num).toFixed(2) %}</span></div>                      </div>                      <ul class="cart_item_bd">                        {% $.each(suit.Skus, function (k, list) { %}                          <li class="cart_item">                            <div class="cart_item_inner">                              <div class="cart_img">                                <a class="cart_img_lk" href="//item.taotao.com/{%= list.Id %}.html" target="_blank">                                  <img src="{%= pageConfig.FN_GetImageDomain(list.Id) %}n5/{%= list.ImgUrl %}" width="50" height="50" alt="">                                </a>                              </div>                              <div class="cart_name">                                <a class="cart_name_lk" href="//item.taotao.com/{%= list.Id %}.html" title="{%= list.Name %}" target="_blank">{%= list.Name %}</a>                              </div>                              <div class="cart_info">                                <div class="cart_price">&yen;{%= list.PromotionPrice.toFixed(2) %}×{%= list.Num %}</div>                                {% if (parseInt(list.FanPrice) > 0) { %}                                  <div class="cart_tag cart_tag_green">返现：&yen;{%= list.FanPrice %}</div>                                {% } %}                                {% if (parseInt(list.Score) > 0) { %}                                  <div class="cart_tag cart_tag_orange">送京豆：{%= list.Score %}</div>                                {% } %}                                {% if (!isVirtual) { %}                                  <a class="cart_delete J_delete" data-id="{%= list.Id %}|{%= suit.Id %}" data-method="RemoveSuit" data-type="{%= list.ItemType %}" href="javascript:;">删除</a>                                {% } %}                              </div>                              {% $.each(list.Gifts, function (k, gift) { %}                                <div class="cart_gift">                                  <a class="cart_gift_lk" href="//item.taotao.com/{%= gift.Id %}.html" target="_blank">[{% if(gift.Type==2) { %}赠品{% } %}{% if(gift.Type==1) { %}附件{% } %}] {%= gift.Name %}</a>                                </div>                              {% }); %}                              {% $.each(list.CouponAD, function (k, jq) { %}                                <div class="cart_gift cart_gift_jq">[赠券] 赠送{%= jq.Jing %}元京券 {%= jq.LimitAd %}                              </div>                              {% }); %}                            </div>                          </li>                        {% }); %}                      </ul>                    </li>                  {% }); %}                </ul>              {% } %}            </li>\t\t\t\t  {% }); %}        </ul>'},FN_BindEvents:function(){var t=this;$("#J_cart_pop .J_delete").bind("click",function(){var i=$(this).attr("data-id").split("|"),s=$(this).attr("data-method"),e=$(this).attr("data-type"),l={method:s,type:e,cartId:i[0]};i&&(i.length>1&&i[1]&&(l.targetId=i[1]),a({url:t.URL_Serv,params:l,dataType:"jsonp"}).then(function(i){i.Result&&t.FN_Refresh()}))})},FN_Refresh:function(){var t=this,s=this.el,e=s.find(".dorpdown-layer").eq(0);a({url:t.URL_Serv,params:{method:"GetCart"},dataType:"jsonp"}).then(function(a){var s=a.Cart,l=s.TheSkus.length+s.TheSuit.length+s.TheGifts.length+s.ManJian.length+s.ManZeng.length,c=i(t.TPL_List.single,a.Cart),r=i(t.TPL_List.gift,a.Cart),d=i(t.TPL_List.suit,a.Cart),n=i(t.TPL_List.mz,a.Cart),_=i(t.TPL_List.mj,a.Cart);l>0?(e.html(i(t.TPL_List.wrap,a.Cart)),e.find(".J_cart_bd").html(c+r+d+_+n)):e.html(t.TPL_NoGoods),t.FN_BindEvents()}),t.DATA_Amount=readCookie(t.DATA_Cookie),null!=t.DATA_Amount&&$("#shopping-amount").html(t.DATA_Amount).parent().show()}};return t});